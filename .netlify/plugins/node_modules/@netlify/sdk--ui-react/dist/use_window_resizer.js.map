{"version":3,"file":"use_window_resizer.js","sources":["../../../node_modules/.pnpm/@react-hook+passive-layout-effect@1.2.1_react@18.2.0/node_modules/@react-hook/passive-layout-effect/dist/module/index.js","../../../node_modules/.pnpm/@react-hook+latest@1.0.3_react@18.2.0/node_modules/@react-hook/latest/dist/module/index.js","../../../node_modules/.pnpm/@react-hook+resize-observer@2.0.2_react@18.2.0/node_modules/@react-hook/resize-observer/dist/module/index.js","../src/use_window_resizer.ts"],"sourcesContent":["import React from 'react';\nconst usePassiveLayoutEffect = React[typeof document !== 'undefined' && document.createElement !== void 0 ? 'useLayoutEffect' : 'useEffect'];\nexport default usePassiveLayoutEffect;","import * as React from 'react';\n\nconst useLatest = current => {\n  const storedValue = React.useRef(current);\n  React.useEffect(() => {\n    storedValue.current = current;\n  });\n  return storedValue;\n};\n\nexport default useLatest;","/* eslint-disable no-return-assign */\n/* eslint-disable no-underscore-dangle */\n\nimport useLayoutEffect from '@react-hook/passive-layout-effect';\nimport useLatest from '@react-hook/latest';\n\n/**\n * A React hook that fires a callback whenever ResizeObserver detects a change to its size\n *\n * @param target A React ref created by `useRef()` or an HTML element\n * @param callback Invoked with a single `ResizeObserverEntry` any time\n *   the `target` resizes\n */\n\nfunction _ref() {}\nfunction useResizeObserver(target, callback, options = {}) {\n  const resizeObserver = getResizeObserver(options.polyfill);\n  const storedCallback = useLatest(callback);\n  useLayoutEffect(() => {\n    let didUnsubscribe = false;\n    const targetEl = target && 'current' in target ? target.current : target;\n    if (!targetEl) return _ref;\n    function cb(entry, observer) {\n      if (didUnsubscribe) return;\n      storedCallback.current(entry, observer);\n    }\n    resizeObserver.subscribe(targetEl, cb);\n    return () => {\n      didUnsubscribe = true;\n      resizeObserver.unsubscribe(targetEl, cb);\n    };\n  }, [target, resizeObserver, storedCallback]);\n  return resizeObserver.observer;\n}\nfunction createResizeObserver(polyfill) {\n  let ticking = false;\n  let allEntries = [];\n  const callbacks = new Map();\n  const observer = new (polyfill || window.ResizeObserver)((entries, obs) => {\n    allEntries = allEntries.concat(entries);\n    function _ref2() {\n      const triggered = new Set();\n      for (let i = 0; i < allEntries.length; i++) {\n        if (triggered.has(allEntries[i].target)) continue;\n        triggered.add(allEntries[i].target);\n        const cbs = callbacks.get(allEntries[i].target);\n        cbs === null || cbs === void 0 ? void 0 : cbs.forEach(cb => cb(allEntries[i], obs));\n      }\n      allEntries = [];\n      ticking = false;\n    }\n    if (!ticking) {\n      window.requestAnimationFrame(_ref2);\n    }\n    ticking = true;\n  });\n  return {\n    observer,\n    subscribe(target, callback) {\n      var _callbacks$get;\n      observer.observe(target);\n      const cbs = (_callbacks$get = callbacks.get(target)) !== null && _callbacks$get !== void 0 ? _callbacks$get : [];\n      cbs.push(callback);\n      callbacks.set(target, cbs);\n    },\n    unsubscribe(target, callback) {\n      var _callbacks$get2;\n      const cbs = (_callbacks$get2 = callbacks.get(target)) !== null && _callbacks$get2 !== void 0 ? _callbacks$get2 : [];\n      if (cbs.length === 1) {\n        observer.unobserve(target);\n        callbacks.delete(target);\n        return;\n      }\n      const cbIndex = cbs.indexOf(callback);\n      if (cbIndex !== -1) cbs.splice(cbIndex, 1);\n      callbacks.set(target, cbs);\n    }\n  };\n}\nlet _resizeObserver;\nconst getResizeObserver = polyfill => !_resizeObserver ? _resizeObserver = createResizeObserver(polyfill) : _resizeObserver;\nexport default useResizeObserver;","import useResizeObserver from \"@react-hook/resize-observer\";\nimport { useEffect, useLayoutEffect, useRef, useState } from \"react\";\nimport { useNetlifySDK } from \"./use_netlify_sdk.js\";\n\nexport interface WindowDimensions {\n  height: number;\n  width: number;\n}\n\nexport const useWindowSizeObserver = (\n  onChange?: (dimensions: WindowDimensions) => void,\n) => {\n  const target = useRef(document.documentElement);\n  const [dimensions, setDimensions] = useState<{\n    height: number;\n    width: number;\n  }>({ height: -1, width: -1 });\n\n  useLayoutEffect(() => {\n    const { height, width } = target.current.getBoundingClientRect();\n\n    if (dimensions.height !== height || dimensions.width !== width) {\n      setDimensions({ height, width });\n    }\n  }, [dimensions.height, dimensions.width, setDimensions, target]);\n\n  useResizeObserver(target, (entry) => {\n    const { height, width } = entry.contentRect;\n\n    if (dimensions.height !== height || dimensions.width !== width) {\n      setDimensions({ height, width });\n    }\n  });\n\n  useEffect(() => {\n    if (typeof onChange === \"function\") {\n      onChange(dimensions);\n    }\n  }, [dimensions, onChange]);\n};\n\nexport const useWindowResizer = () => {\n  const sdk = useNetlifySDK();\n\n  useWindowSizeObserver(sdk.requestDimensions);\n};\n"],"names":["React","useLayoutEffect"],"mappings":"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","x_google_ignoreList":[0,1,2]}