{"version":3,"file":"index.dev.mjs","sources":["../../src/index.tsx"],"sourcesContent":["/* eslint-disable no-return-assign */\n/* eslint-disable no-underscore-dangle */\nimport * as React from 'react'\nimport useLayoutEffect from '@react-hook/passive-layout-effect'\nimport useLatest from '@react-hook/latest'\n\n/**\n * A React hook that fires a callback whenever ResizeObserver detects a change to its size\n *\n * @param target A React ref created by `useRef()` or an HTML element\n * @param callback Invoked with a single `ResizeObserverEntry` any time\n *   the `target` resizes\n */\nfunction useResizeObserver<T extends Element>(\n  target: React.RefObject<T> | React.ForwardedRef<T> | T | null,\n  callback: UseResizeObserverCallback,\n  options: UseResizeObserverOptions = {}\n): ResizeObserver {\n  const resizeObserver = getResizeObserver(options.polyfill)\n  const storedCallback = useLatest(callback)\n\n  useLayoutEffect(() => {\n    let didUnsubscribe = false\n    const targetEl = target && 'current' in target ? target.current : target\n    if (!targetEl) return () => {}\n\n    function cb(entry: ResizeObserverEntry, observer: ResizeObserver) {\n      if (didUnsubscribe) return\n      storedCallback.current(entry, observer)\n    }\n\n    resizeObserver.subscribe(targetEl as Element, cb)\n\n    return () => {\n      didUnsubscribe = true\n      resizeObserver.unsubscribe(targetEl as Element, cb)\n    }\n  }, [target, resizeObserver, storedCallback])\n\n  return resizeObserver.observer\n}\n\nfunction createResizeObserver(polyfill?: any) {\n  let ticking = false\n  let allEntries: ResizeObserverEntry[] = []\n\n  const callbacks: Map<any, Array<UseResizeObserverCallback>> = new Map()\n\n  const observer = new (polyfill || window.ResizeObserver)(\n    (entries: ResizeObserverEntry[], obs: ResizeObserver) => {\n      allEntries = allEntries.concat(entries)\n      if (!ticking) {\n        window.requestAnimationFrame(() => {\n          const triggered = new Set<Element>()\n          for (let i = 0; i < allEntries.length; i++) {\n            if (triggered.has(allEntries[i].target)) continue\n            triggered.add(allEntries[i].target)\n            const cbs = callbacks.get(allEntries[i].target)\n            cbs?.forEach((cb) => cb(allEntries[i], obs))\n          }\n          allEntries = []\n          ticking = false\n        })\n      }\n      ticking = true\n    }\n  )\n\n  return {\n    observer,\n    subscribe(target: Element, callback: UseResizeObserverCallback) {\n      observer.observe(target)\n      const cbs = callbacks.get(target) ?? []\n      cbs.push(callback)\n      callbacks.set(target, cbs)\n    },\n    unsubscribe(target: Element, callback: UseResizeObserverCallback) {\n      const cbs = callbacks.get(target) ?? []\n      if (cbs.length === 1) {\n        observer.unobserve(target)\n        callbacks.delete(target)\n        return\n      }\n      const cbIndex = cbs.indexOf(callback)\n      if (cbIndex !== -1) cbs.splice(cbIndex, 1)\n      callbacks.set(target, cbs)\n    },\n  }\n}\n\nlet _resizeObserver: ReturnType<typeof createResizeObserver>\n\nconst getResizeObserver = (polyfill: any) =>\n  !_resizeObserver\n    ? (_resizeObserver = createResizeObserver(polyfill))\n    : _resizeObserver\n\nexport type UseResizeObserverCallback = (\n  entry: ResizeObserverEntry,\n  observer: ResizeObserver\n) => any\n\nexport type UseResizeObserverOptions = {polyfill?: any}\nexport default useResizeObserver\n"],"names":["_ref","useResizeObserver","target","callback","options","resizeObserver","getResizeObserver","polyfill","storedCallback","useLatest","useLayoutEffect","didUnsubscribe","targetEl","current","cb","entry","observer","subscribe","unsubscribe","createResizeObserver","ticking","allEntries","callbacks","Map","window","ResizeObserver","entries","obs","concat","_ref2","triggered","Set","_loop","i","has","add","cbs","get","forEach","length","_ret","requestAnimationFrame","_callbacks$get","observe","push","set","_callbacks$get2","unobserve","delete","cbIndex","indexOf","splice","_resizeObserver"],"mappings":"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"}