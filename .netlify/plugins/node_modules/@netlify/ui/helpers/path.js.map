{"version":3,"file":"path.js","sources":["../../../../libs/ui/src/helpers/path.ts"],"sourcesContent":["/**\n * These path helpers are a non-Immutable port of the original path helpers.\n * They are used to generate URLs for the Netlify app, and are stricter than the original code.\n * The original code allowed undefined objects and strings, but this version is stricter.\n * Restore the original code if it causes issues.\n *\n * @see {@link file://./../../../../apps/netlify-react-ui/src/helpers/path.ts}\n */\n\ntype OrganizationWithRequiredSlug = {\n  slug: string;\n};\n\ntype AccountWithRequiredSlug = {\n  slug: string;\n};\n\ntype SiteWithRequiredName = {\n  name: string;\n};\n\ntype DeployWithRequiredId = {\n  id: string;\n  branch?: string | undefined;\n  context?: string | undefined;\n  review_id?: number | undefined;\n};\n\n// XXX(ndhoule): It's super confusing that this is named `FunctionWithRequiredN` but n is optional.\n// But, I'm just leaving this as I found it... :laughcry:\ntype FunctionWithRequiredN = {\n  n?: string | undefined;\n};\n\ntype BuildWithRequiredDeployId = {\n  deploy_id: string;\n};\n\ntype DevServer = {\n  id?: string | undefined;\n  site_id?: string | undefined;\n};\n\nexport function sitesPath(account: AccountWithRequiredSlug): string {\n  return accountPath(account, 'sites');\n}\n\nexport function sitePath(\n  site: SiteWithRequiredName,\n  ...rest: string[]\n): string {\n  return ['/sites', site.name, ...rest].join('/');\n}\n\nexport function siteSettingsPath(\n  site: SiteWithRequiredName,\n  ...rest: string[]\n): string {\n  return sitePath(site, 'configuration', ...rest);\n}\n\nexport function deploysPath(site: SiteWithRequiredName): string {\n  return sitePath(site, 'deploys');\n}\n\nexport function deployPath(\n  site: SiteWithRequiredName,\n  deploy: DeployWithRequiredId\n): string {\n  return sitePath(site, 'deploys', deploy.id);\n}\n\nexport function devServerPathWithSite(\n  site: SiteWithRequiredName,\n  devServer?: DevServer\n): string {\n  if (!devServer?.id) {\n    return sitePath(site, 'preview-servers');\n  }\n  return sitePath(site, 'preview-servers', devServer.id);\n}\n\nexport function devServerPath(devServer: DevServer): string {\n  return ['/sites', devServer.site_id, 'preview-servers', devServer.id].join(\n    '/'\n  );\n}\n\nexport function buildsPath(\n  account: AccountWithRequiredSlug,\n  ...rest: string[]\n): string {\n  return accountPath(account, 'builds', ...rest);\n}\n\nexport function buildPath(\n  account: AccountWithRequiredSlug,\n  build: BuildWithRequiredDeployId\n): string {\n  return buildsPath(account, build.deploy_id);\n}\n\nexport function membersPath(\n  account: AccountWithRequiredSlug,\n  ...rest: string[]\n): string {\n  return accountPath(account, 'members', ...rest);\n}\n\nexport function membersBuildPath(\n  account: AccountWithRequiredSlug,\n  deployId: string,\n  ...rest: string[]\n): string {\n  return accountPath(account, 'members', ...rest, 'build', deployId);\n}\n\nfunction functionsScopeQuery(deploy: DeployWithRequiredId): string {\n  if (!deploy) return '';\n  switch (deploy.context) {\n    case 'branch-deploy':\n      return `?scope=branch:${deploy.branch}`;\n    case 'deploy-preview':\n      return `?scope=deploypreview:${deploy.review_id || deploy.id}`;\n    default:\n      return '';\n  }\n}\n\nexport function functionsPath(\n  site: SiteWithRequiredName,\n  deploy: DeployWithRequiredId\n): string {\n  return `${sitePath(site, 'logs', 'functions')}${functionsScopeQuery(deploy)}`;\n}\n\nexport function functionPath(\n  site: SiteWithRequiredName,\n  func: FunctionWithRequiredN,\n  scope?: string\n): string {\n  let funcPath = `${sitePath(site, 'logs', 'functions', encodeURIComponent(func.n!))}`;\n  if (scope) {\n    funcPath += `?scope=${scope}`;\n  }\n  return funcPath;\n}\n\nexport function functionPathWithTimeRangeAndBranch({\n  siteName,\n  funcName,\n  from,\n  to,\n  branch,\n}: {\n  siteName: string;\n  funcName?: string;\n  from?: number;\n  to?: number;\n  branch?: string;\n}): string {\n  return `/sites/${siteName}/logs/functions/${funcName && encodeURIComponent(funcName)}${from && to ? `?from=${from}&to=${to}` : ''}${branch ? `&scope=branch:${branch}` : ''}`;\n}\n\nexport function edgeFunctionsPath(\n  site: SiteWithRequiredName,\n  query?: string\n): string {\n  const path = sitePath(site, 'logs', 'edge-functions');\n  return query ? `${path}?scope=${query}` : path;\n}\n\nexport function edgeFunctionsPathWithTimeRangeAndBranch({\n  siteName,\n  from,\n  to,\n  branch,\n  isMainBranch,\n}: {\n  siteName: string;\n  from?: number;\n  to?: number;\n  branch?: string;\n  isMainBranch?: boolean;\n}): string {\n  const scope = `&scope=${isMainBranch ? 'production' : `branch:${branch}`}`;\n  return `/sites/${siteName}/logs/edge-functions${from && to ? `?from=${from}&to=${to}` : ''}${scope}`;\n}\n\nexport function formsPath(site: SiteWithRequiredName): string {\n  return sitePath(site, 'forms');\n}\n\nexport function formPath(site: SiteWithRequiredName, formId?: string): string {\n  return formId ? sitePath(site, 'forms', formId) : formsPath(site);\n}\n\nexport function dnsPath(\n  account: AccountWithRequiredSlug,\n  ...rest: string[]\n): string {\n  return accountPath(account, 'dns', ...rest);\n}\n\nexport function accountPath(\n  account: AccountWithRequiredSlug,\n  ...rest: string[]\n): string {\n  return ['/teams', account.slug, ...rest].join('/');\n}\n\nexport function reviewerPath(\n  account: AccountWithRequiredSlug,\n  ...rest: string[]\n): string {\n  return accountPath(account, 'reviewer', ...rest);\n}\n\nexport function teamSettingsPath(\n  account: AccountWithRequiredSlug,\n  ...rest: string[]\n): string {\n  return accountPath(account, 'settings', ...rest);\n}\n\nexport function teamAuditLogPath(\n  account: AccountWithRequiredSlug,\n  ...rest: string[]\n): string {\n  return accountPath(account, 'log', ...rest);\n}\n\nexport function billingPath(\n  account: AccountWithRequiredSlug,\n  ...rest: string[]\n): string {\n  return accountPath(account, 'billing', ...rest);\n}\n\nexport function enterpriseUpgradePath(\n  account: AccountWithRequiredSlug\n): string {\n  const params = new URLSearchParams({ plan: 'enterprise' });\n  return `${billingPath(account, 'payment')}?${params.toString()}`;\n}\n\nexport function getPathSegments(path: string): string[] {\n  return path.split('/').filter(Boolean);\n}\n\nexport function getPathSegmentsWithoutParams(\n  path: string,\n  params: Record<string, string> = {}\n): string[] {\n  const paramValues = Object.values(params);\n  return getPathSegments(path).filter(\n    (segment) => !paramValues.includes(segment)\n  );\n}\n\nexport function getLastSegmentOfPath(path: string): string {\n  return getPathSegments(path).pop() || '';\n}\n\nexport function forumsPath(path = ''): string {\n  return `https://answers.netlify.com/${path}`;\n}\n\nexport function blogPath(path = ''): string {\n  return `https://blog.netlify.com/${path}`;\n}\n\nexport function organizationPath(\n  organization: OrganizationWithRequiredSlug,\n  ...rest: string[]\n): string {\n  return ['/organizations', organization.slug, ...rest].join('/');\n}\n\nexport function integrationsPath(path = ''): string {\n  return `https://www.netlify.com/integrations/${path}`;\n}\n\nexport function docsPathWithHash(...rest: string[]): string {\n  let hash = rest.pop() || '';\n  if (!hash.startsWith('#')) {\n    hash = `#${hash}`;\n  }\n  return ['https://docs.netlify.com', ...rest, hash].join('/');\n}\n\nexport function docsPath(...rest: string[]): string {\n  return ['https://docs.netlify.com', ...rest, ''].join('/');\n}\n\nexport function pathnameMatchesPattern(regexp: RegExp): boolean {\n  return regexp.test(window.location.pathname);\n}\n"],"names":[],"mappings":"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"}